CREATE USER TEAM3 IDENTIFIED BY team3;
GRANT CONNECT, RESOURCE TO TEAM3;
GRANT ALTER SESSION TO TEAM3;

CONN TEAM3/team3;

SHOW USER;

-- 게시판
DROP TABLE BOARD CASCADE CONSTRAINT;
CREATE TABLE BOARD(
  NO NUMBER,            						-- 게시글번호
  WRITER VARCHAR2(30),							-- 작성자
  TITLE VARCHAR2(1000),        					-- 게시글제목
  CONTENT VARCHAR2(4000),    					-- 게시글내용
  REGDATE DATE DEFAULT SYSDATE,        			-- 게시글작성날짜
  CNT NUMBER DEFAULT 0,    						-- 조회수
  FILENAME VARCHAR2(200),						-- 이미지업로드
  CONSTRAINT BOARD_PK PRIMARY KEY(NO)
);

INSERT INTO BOARD(NO,WRITER,TITLE,CONTENT) VALUES(1,'test','안녕하세요 ','첫 게시글입니다 반가워요');


COLUMN CNT FORMAT 999;
COLUMN REGDATE FORMAT A20;
COLUMN CONTENT FORMAT A30;
COLUMN TITLE FORMAT A10;
COLUMN WRITER FORMAT A10;
COLUMN NO FORMAT 999;

-- 공지사항 시퀀스
DROP SEQUENCE UNI_SEQ;
CREATE SEQUENCE UNI_SEQ INCREMENT BY 1 MAXVALUE 1000;


-- 공지사항
DROP TABLE NOTICE CASCADE CONSTRAINT;
CREATE TABLE NOTICE(
  UNI NUMBER CONSTRAINT NOTICE_UNI_PK PRIMARY KEY,			-- 고유번호
  NO VARCHAR2(10),            						 		-- 게시글번호
  WRITER VARCHAR2(30),										-- 작성자
  TITLE VARCHAR2(1000),        								-- 게시글제목
  CONTENT VARCHAR2(4000),    								-- 게시글내용
  REGDATE DATE DEFAULT SYSDATE,          					-- 게시글작성날짜
  CNT NUMBER DEFAULT 0    									-- 조회수
);

SELECT UNI_SEQ.NEXTVAL FROM DUAL;
INSERT INTO NOTICE(NO,WRITER,TITLE,CONTENT,UNI) VALUES('공지','test','공지사항입니다. 필독 바랍니다. ','냉무',(UNI_SEQ.CURRVAL));


-- 사용자 고유번호 시퀀스
DROP SEQUENCE MEM_SEQ;
CREATE SEQUENCE MEM_SEQ;

SELECT MEM_SEQ.NEXTVAL FROM DUAL;

-- 사용자
DROP TABLE MEMBER CASCADE CONSTRAINT;
CREATE TABLE MEMBER(
  ID VARCHAR2(20) ,                 					-- 아이디
  ROLE VARCHAR2(10),									-- 권한
  PASSWORD VARCHAR2(20),                   				-- 패스워드
  EMAIL VARCHAR2(50),                    				-- 이메일
  IMAGE VARCHAR2(1000),              					-- 유저이미지
  NAME VARCHAR2(20),                   					-- 이름
  BIRTH DATE,                 							-- 생일
  POST VARCHAR2(20),                  					-- 우편번호
  ADDRESS VARCHAR2(100),                 				-- 주소
  MEM_CODE VARCHAR2(100),								-- 고유코드
  PHONE VARCHAR2(100),									-- 휴대폰번호
  CONSTRAINT MEMBER_ID_PK PRIMARY KEY(ID)			
);


INSERT INTO MEMBER VALUES('test','admin','test123','boreds@daum.net','lion_profile.png','멍냥컴퍼니 관리1팀',sysdate,'08500','서울 금천구 가마산로 76(가산동)',CONCAT('ME00',TO_CHAR(MEM_SEQ.CURRVAL)),'010-0000-0000');
INSERT INTO MEMBER VALUES('user','user','user123','user@naver.com','lion_profile.png','김해민',sysdate,'21510','인천 남동구 간석로 7(간석동)',CONCAT('ME00',TO_CHAR(MEM_SEQ.NEXTVAL)),'010-0000-0000');



column id format a10;
column pw format a8;
column post format a10;
column email format a20;
column image format a10;
column name format a10;
column address format a8;
column MEM_CODE format a8;
SET LINE 150
SET PAGES 50


--댓글정보
DROP TABLE BOARD_COMMENT CASCADE CONSTRAINT;
CREATE TABLE BOARD_COMMENT(
  COMMENT_NO NUMBER PRIMARY KEY	,				-- 댓글 번호
  NO NUMBER,            					 	-- 게시글번호
  WRITER VARCHAR2(30),							-- 작성자
  CONTENT VARCHAR2(1000),         				-- 댓글내용
  REGDATE DATE DEFAULT SYSDATE,           		-- 댓글날짜	
  CONSTRAINT B_COMMENT_FK_BOARD FOREIGN KEY(NO) REFERENCES BOARD(NO)
);

INSERT INTO BOARD_COMMENT VALUES((SELECT NVL(MAX(COMMENT_NO), 0) + 1 FROM BOARD_COMMENT),1,'김이박','첫댓글입니다. 반가워요',SYSDATE);

-- 게시판 공감도정보
DROP TABLE B_MOOD CASCADE CONSTRAINT;
CREATE TABLE B_MOOD(
  NO NUMBER,             						-- 게시판_넘버
  GOOD NUMBER DEFAULT 0,                		-- 좋아요
  BAD NUMBER DEFAULT 0,							-- 싫어요
  CONSTRAINT B_MOOD_PK PRIMARY KEY(NO),
  CONSTRAINT B_MOOD_FK_BOARD FOREIGN KEY(NO) REFERENCES BOARD(NO)
);

INSERT INTO B_MOOD VALUES((SELECT NVL(MAX(NO), 0) FROM BOARD),1,1);

-- 댓글 공감도정보
DROP TABLE C_MOOD CASCADE CONSTRAINT;
CREATE TABLE C_MOOD(
  NO NUMBER,             						-- 게시판_넘버
  COMMENT_NO NUMBER,							-- 댓글_넘버
  GOOD NUMBER DEFAULT 0,                		-- 좋아요
  BAD NUMBER DEFAULT 0,							-- 싫어요
  CONSTRAINT C_MOOD_PK PRIMARY KEY(COMMENT_NO),
  CONSTRAINT C_MOOD_FK_COMMENT FOREIGN KEY(COMMENT_NO) REFERENCES BOARD_COMMENT(COMMENT_NO)
);

INSERT INTO C_MOOD VALUES(1,(SELECT NVL(MAX(COMMENT_NO), 0) FROM BOARD_COMMENT),1,1);

-- 예약정보 시퀀스
DROP SEQUENCE RESER_SEQ;
CREATE SEQUENCE RESER_SEQ INCREMENT BY 1 MAXVALUE 1000;

-- 예약정보
DROP TABLE RESERVATION CASCADE CONSTRAINT;
CREATE TABLE RESERVATION(
  NO NUMBER,             						-- 예약_넘버
  KIND VARCHAR2(100),							-- 동물종류
  USER_ID VARCHAR2(100),						-- 예약자 아이디
  USER_NAME VARCHAR2(100),                		-- 예약자 이름
  RESER_DATE DATE DEFAULT SYSDATE,				-- 예약 일자
  TITLE VARCHAR2(100),							-- 예약 목적
  CONTENT VARCHAR2(100),						-- 예약 내용
  CONTENT_ELSE VARCHAR2(1000),
  CONSTRAINT RESERVATION_PK PRIMARY KEY(NO)
);

-- 네아로 시퀀스
DROP SEQUENCE NAVERLOGIN_NO;
CREATE SEQUENCE NAVERLOGIN_NO INCREMENT BY 1;

-- 네이버 로그인 연동
DROP TABLE NAVERLOGIN CASCADE CONSTRAINT;
CREATE TABLE NAVERLOGIN(
  NO NUMBER,             						-- 고유번호
  ID VARCHAR2(20),								-- 사용자 아이디
  NAVERLOGIN_ID VARCHAR2(100),             		-- 네아로 사용자 고유번호
  EMAIL VARCHAR2(50),							-- 네아로 사용자 이메일
  MOBILE VARCHAR2(30),							-- 네아로 사용자 핸드폰번호
  PROFILE_IMAGE VARCHAR2(200),					-- 네아로 사용자 이미지
  CONSTRAINT NAVERLOGIN_PK PRIMARY KEY(NO),
  CONSTRAINT NAVERLOGIN_FK_MEMBER FOREIGN KEY(ID) REFERENCES MEMBER(ID)
);



column no format 999;
column kind format a5;
column user_id format a10;
column user_name format a20;
column reser_date format a10;
column title format a20;
column content format a10;
column content_else format a30;



-- 제품 시퀀스
DROP SEQUENCE PRO_SEQ;
CREATE SEQUENCE PRO_SEQ;


--제품정보
DROP TABLE PRODUCT CASCADE CONSTRAINT;
CREATE TABLE PRODUCT(
  PRO_CODE VARCHAR2(20),            -- 제품코드
  IMAGE VARCHAR2(70),               -- 제품이미지
  IMAGE_DETAIL VARCHAR2(70),		-- 제품 상세이미지
  NAME VARCHAR2(200),               -- 제품명
  PRICE NUMBER,						-- 제품단가
  REG_DATE DATE,             		-- 제품등록일
  CONTENT VARCHAR2(1000),
  CONSTRAINT PRODUCT_PK PRIMARY KEY(PRO_CODE)
);


SELECT PRO_SEQ.NEXTVAL FROM DUAL;

INSERT INTO PRODUCT VALUES(CONCAT('PR00',TO_CHAR(PRO_SEQ.CURRVAL)),'dog_pad.png','dog_pad_detail.png','강아지 배변패드 200매',26000,'2021/05/04','향기와 흡수를 모두 갖춘 강아지 맞춤 배변패드');
INSERT INTO PRODUCT VALUES(CONCAT('PR00',TO_CHAR(PRO_SEQ.NEXTVAL)),'cat_tower.png','cat_tower_detail.jpg','원목 캣타워',32400,'2021/04/11','고양이들을 위한 놀이터/보금자리');
INSERT INTO PRODUCT VALUES(CONCAT('PR00',TO_CHAR(PRO_SEQ.NEXTVAL)),'cat_sand.png','cat_sand_detail.png','고양이 모래 4.5kg',17600,'2021/03/03','탈취력이 우수하고 먼지날림이 없는 고양이 모래');
INSERT INTO PRODUCT VALUES(CONCAT('PR00',TO_CHAR(PRO_SEQ.NEXTVAL)),'dog_food.png','dog_food_detail.png','강아지 사료 7kg',48000,'2021/05/23','유해성분 Zero ! 안전한 강아지 사료');
INSERT INTO PRODUCT VALUES(CONCAT('PR00',TO_CHAR(PRO_SEQ.NEXTVAL)),'cat_scratcher.png','cat_scratcher_detail.jpg','고양이 스크래쳐',18000,'2021/04/27','고양이들의 본능을 지켜줄 안성맞춤 스크래쳐');
INSERT INTO PRODUCT VALUES(CONCAT('PR00',TO_CHAR(PRO_SEQ.NEXTVAL)),'cat_toy.png','cat_toy_detail.jpg','고양이 자동장난감',22000,'2021/03/15','심심한 고양이의 시간을 책임질 캣토이');
INSERT INTO PRODUCT VALUES(CONCAT('PR00',TO_CHAR(PRO_SEQ.NEXTVAL)),'dog_tissue.png','dog_tissue_detail.png','강아지 노즈워크 멍티슈',9800,'2021/02/11','강아지의 후각발달을 책임질 노즈워크 장난감');
INSERT INTO PRODUCT VALUES(CONCAT('PR00',TO_CHAR(PRO_SEQ.NEXTVAL)),'dog_snack.png','dog_snack_detail.png','강아지 영양간식 100개입',35000,'2021/04/19','강아지의 치아건강을 위한 영양간식');
INSERT INTO PRODUCT VALUES(CONCAT('PR00',TO_CHAR(PRO_SEQ.NEXTVAL)),'cat_snack.png','cat_snack_detail.jpg','고양이 츄르 100개입',31000,'2021/05/09','1일 1츄르의 공식,마성의 고양이 간식');

--판매내역정보
DROP TABLE BILL CASCADE CONSTRAINT;
CREATE TABLE BILL(
  SELL_CODE NUMBER,					-- 판매내역코드
  PRO_CODE VARCHAR2(100),			-- 제품코드
  PRO_NAME VARCHAR2(100),			-- 제품이름
  MEM_CODE VARCHAR2(100),			-- 유저코드
  PRICE NUMBER,						-- 판매총가격
  COUNT NUMBER,						-- 판매총수량
  SELL_DATE DATE,					-- 결제일
  ADDRESS VARCHAR2(100),			-- 배송지
  PHONE VARCHAR2(100),				-- 주문자 연락처
  NAME VARCHAR2(100),				-- 주문자 이름
  REQ VARCHAR2(100),				-- 요청사항
  CONSTRAINT BILL_PK PRIMARY KEY(SELL_CODE,PRO_CODE),
  CONSTRAINT BILL_FK_PRODUCT FOREIGN KEY(PRO_CODE) REFERENCES PRODUCT(PRO_CODE)
);

--장바구니정보
DROP TABLE CART CASCADE CONSTRAINT;
CREATE TABLE CART(
  CART_CODE NUMBER,				-- 장바구니코드
  PRO_CODE VARCHAR2(20),		-- 제품코드
  PRO_NAME VARCHAR2(100),		-- 제품이름
  MEM_CODE VARCHAR2(20),		-- 유저코드
  PRICE NUMBER,					-- 해당제품총가격
  COUNT NUMBER,					-- 해당제품총수량
  SAVE_DATE DATE,				-- 장바구니 저장일
  IMAGE VARCHAR2(100),			-- 이미지
  PRO_CHECK NUMBER,				-- 장바구니 선택유무
  CONSTRAINT CART_PK PRIMARY KEY(CART_CODE),
  CONSTRAINT CART_FK_PRODUCT FOREIGN KEY(PRO_CODE) REFERENCES PRODUCT(PRO_CODE)
);

DROP TABLE REVIEW CASCADE CONSTRAINT;   
CREATE TABLE REVIEW(
  REVIEW_CODE NUMBER,				-- 리뷰 번호
  PRO_CODE VARCHAR2(20),				-- 제품코드
  PRO_NAME VARCHAR2(20),				-- 제품이름
  MEM_CODE VARCHAR2(20),			-- 유저코드
  PRICE NUMBER,					-- 판매총가격
  REVIEW_DATE DATE,				-- 댓글 등록일
  NAME VARCHAR2(100),				-- 주문자 이름
  CONTENT VARCHAR2(1000),				-- 리뷰
  CONSTRAINT REVIEW_PK PRIMARY KEY(REVIEW_CODE),
  CONSTRAINT REVIEW_FK_PRODUCT FOREIGN KEY(PRO_CODE) REFERENCES PRODUCT(PRO_CODE)
);

DROP TABLE REVIEW_HISTORY CASCADE CONSTRAINT;
CREATE TABLE REVIEW_HISTORY(
  HISTORY_CODE NUMBER,				-- 리뷰작성코드
  PRO_CODE VARCHAR2(20),				-- 제품코드
  MEM_CODE VARCHAR2(20),			-- 유저코드
  SELL_CODE NUMBER,  				-- 판매내역코드
  CONSTRAINT HISTORY_PK PRIMARY KEY(HISTORY_CODE),
  CONSTRAINT HISTORY_FK_BILL FOREIGN KEY(SELL_CODE,PRO_CODE) REFERENCES BILL(SELL_CODE,PRO_CODE)
);

DROP TABLE B_MOOD_HISTORY CASCADE CONSTRAINT;
CREATE TABLE B_MOOD_HISTORY(
  NO NUMBER,             						-- 게시판_넘버
  MEM_CODE VARCHAR2(100),						-- 사용자 코드
  CONSTRAINT B_MOOD_HISTORY_PK PRIMARY KEY(NO),
  CONSTRAINT B_MOOD_HISTORY_FK_BOARD FOREIGN KEY(NO) REFERENCES BOARD(NO)
);

DROP TABLE C_MOOD_HISTORY CASCADE CONSTRAINT;
CREATE TABLE C_MOOD_HISTORY(
  NO NUMBER,             						-- 게시판_넘버
  COMMENT_NO NUMBER,							-- 댓글 넘버
  MEM_CODE VARCHAR2(100),						-- 사용자 코드
  CONSTRAINT C_MOOD_HISTORY_PK PRIMARY KEY(NO,COMMENT_NO),
  CONSTRAINT C_MOOD_HISTORY_FK_COMMENT FOREIGN KEY(COMMENT_NO) REFERENCES BOARD_COMMENT(COMMENT_NO)
);

DROP TABLE PET_STORY CASCADE CONSTRAINT;
CREATE TABLE PET_STORY(
  NO NUMBER,            						-- 게시글번호
  WRITER VARCHAR2(30),							-- 작성자
  TITLE VARCHAR2(1000),        					-- 게시글제목
  CONTENT VARCHAR2(4000),    					-- 게시글내용
  REGDATE DATE DEFAULT SYSDATE,        			-- 게시글작성날짜
  CNT NUMBER DEFAULT 0,    						-- 조회수
  FILENAME VARCHAR2(200),						-- 이미지업로드
  CONSTRAINT STORY_PK PRIMARY KEY(NO)
);

INSERT INTO PET_STORY(NO,WRITER,TITLE,CONTENT) VALUES(1,'test','안녕하세요 ','첫 게시글입니다 반가워요');

DROP TABLE P_COMMENT CASCADE CONSTRAINT;
CREATE TABLE P_COMMENT(
  COMMENT_NO NUMBER PRIMARY KEY	,				-- 댓글 번호
  NO NUMBER,            					 	-- 게시글번호
  WRITER VARCHAR2(30),							-- 작성자
  CONTENT VARCHAR2(1000),         				-- 댓글내용
  REGDATE DATE DEFAULT SYSDATE,           		-- 댓글날짜	
  CONSTRAINT P_COMMENT_FK_PET_STORY FOREIGN KEY(NO) REFERENCES PET_STORY(NO)
);

INSERT INTO P_COMMENT VALUES((SELECT NVL(MAX(COMMENT_NO), 0) + 1 FROM BOARD_COMMENT),1,'김이박','첫댓글입니다. 반가워요',SYSDATE);

-- 게시판 공감도정보
DROP TABLE P_MOOD CASCADE CONSTRAINT;
CREATE TABLE P_MOOD(
  NO NUMBER,             						-- 게시판_넘버
  GOOD NUMBER DEFAULT 0,                		-- 좋아요
  BAD NUMBER DEFAULT 0,							-- 싫어요
  CONSTRAINT P_MOOD_PK PRIMARY KEY(NO),
  CONSTRAINT P_MOOD_FK_PET_STORY FOREIGN KEY(NO) REFERENCES PET_STORY(NO)
);

INSERT INTO P_MOOD VALUES((SELECT NVL(MAX(NO), 0) FROM PET_STORY),1,1);

-- 댓글 공감도정보
DROP TABLE P_COMMENT_MOOD CASCADE CONSTRAINT;
CREATE TABLE P_COMMENT_MOOD(
  NO NUMBER,             						-- 게시판_넘버
  COMMENT_NO NUMBER,							-- 댓글_넘버
  GOOD NUMBER DEFAULT 0,                		-- 좋아요
  BAD NUMBER DEFAULT 0,							-- 싫어요
  CONSTRAINT P_COMMENT_MOOD_PK PRIMARY KEY(COMMENT_NO),
  CONSTRAINT P_COMMENT_MOOD_FK_COMMENT FOREIGN KEY(COMMENT_NO) REFERENCES P_COMMENT(COMMENT_NO)
);

INSERT INTO P_COMMENT_MOOD VALUES(1,(SELECT NVL(MAX(COMMENT_NO), 0) FROM P_COMMENT),1,1);

DROP TABLE P_MOOD_HISTORY CASCADE CONSTRAINT;
CREATE TABLE P_MOOD_HISTORY(
  NO NUMBER,             						-- 게시판_넘버
  MEM_CODE VARCHAR2(100),						-- 사용자 코드
  CONSTRAINT P_MOOD_HISTORY_PK PRIMARY KEY(NO),
  CONSTRAINT P_MOOD_HISTORY_FK_BOARD FOREIGN KEY(NO) REFERENCES PET_STORY(NO)
);

DROP TABLE P_C_MOOD_HISTORY CASCADE CONSTRAINT;
CREATE TABLE P_C_MOOD_HISTORY(
  NO NUMBER,             						-- 게시판_넘버
  COMMENT_NO NUMBER,							-- 댓글 넘버
  MEM_CODE VARCHAR2(100),						-- 사용자 코드
  CONSTRAINT P_C_MOOD_HISTORY_PK PRIMARY KEY(NO,COMMENT_NO),
  CONSTRAINT P_C_MOOD_HISTORY_FK_COMMENT FOREIGN KEY(COMMENT_NO) REFERENCES P_COMMENT(COMMENT_NO)
);

column PRO_CODE format a10;
column IMAGE format a20;
column NAME format a15;
column PRICE format 99999;
column REG_DATE format a15;
column CONTENT format a20;
column SELL_CODE format 999;
column CART_CODE format 99;
column PHONE format a10;
column REQ format a20;

column PRO_CODE format a10;
column MEM_CODE format a10;
column COUNT format 99;
column SAVE_DATE format a15;
column SELL_DATE format a15;


COMMIT;

